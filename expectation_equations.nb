(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     10069,        263]
NotebookOptionsPosition[      9514,        241]
NotebookOutlinePosition[      9894,        258]
CellTagsIndexPosition[      9851,        255]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", "10"}], ";"}]}], "Input",
 CellChangeTimes->{{3.603175268745393*^9, 3.603175276253675*^9}, {
   3.603175460915882*^9, 3.60317546114013*^9}, {3.603175734896934*^9, 
   3.603175735120726*^9}, {3.603178970994306*^9, 3.6031789721135674`*^9}, {
   3.6031803249735603`*^9, 3.603180345645788*^9}, {3.603180498285638*^9, 
   3.603180498540078*^9}, {3.6031805290369463`*^9, 3.603180529371275*^9}, 
   3.603181228910069*^9, {3.603182609433366*^9, 3.6031826109049873`*^9}, {
   3.6031840855652*^9, 3.603184120189147*^9}, {3.603184470370159*^9, 
   3.603184470482005*^9}, {3.603188754915016*^9, 3.603188755162216*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}], "]"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "a"}], "+", "b"}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "]"}], "\[Rule]", "a"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{"a", "+", "b"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{"n", ",", "n"}], "]"}], "]"}], "=", 
   RowBox[{"-", "a"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Normal", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "A", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.603175181384499*^9, 3.603175183529831*^9}, {
   3.6031752360219707`*^9, 3.603175288942589*^9}, {3.6031753218067093`*^9, 
   3.603175571874586*^9}, {3.603175636410797*^9, 3.60317567547374*^9}, {
   3.6031757623311377`*^9, 3.603175781105287*^9}, 3.603178997505302*^9, {
   3.603179309342963*^9, 3.603179366544778*^9}, {3.603180302038685*^9, 
   3.603180318783231*^9}, 3.603182015431347*^9, {3.60318414392572*^9, 
   3.6031841451246853`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"s", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"s", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"s", "=", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{"0", "&"}], ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"v", "=", "s"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{"c", "-", 
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"[", "n", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"-", "d"}], "-", 
      RowBox[{"v", "[", 
       RowBox[{"[", "n", "]"}], "]"}]}]}], ";"}], "\n", "v"}]}]], "Input",
 CellChangeTimes->{{3.6031758543798447`*^9, 3.603175876751957*^9}, 
   3.603175909184524*^9, {3.603176092381751*^9, 3.603176115940707*^9}, {
   3.603176179506957*^9, 3.603176185247961*^9}, {3.603176266679048*^9, 
   3.603176328911685*^9}, {3.603176360965952*^9, 3.6031763664311953`*^9}, {
   3.6031767115725927`*^9, 3.603176724510865*^9}, {3.60317987570581*^9, 
   3.603179881576592*^9}, 3.6031803046647387`*^9, 3.6031821128480587`*^9, {
   3.603184377689193*^9, 3.60318445928284*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"Y", ",", "sol", ",", "system", ",", "init"}], "]"}]], "Input",
 CellChangeTimes->{{3.603178891817524*^9, 3.603178897306378*^9}, {
  3.6031789449701633`*^9, 3.6031789469939613`*^9}, {3.603180256023342*^9, 
  3.6031802623114567`*^9}, {3.60318195741418*^9, 3.603181974247114*^9}, {
  3.603182143901908*^9, 3.603182151245275*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ys", "[", "t_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Y", "[", "i", "]"}], "[", "t", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6031770215503798`*^9, 3.603177035544004*^9}, {
   3.6031785739663057`*^9, 3.603178580405682*^9}, {3.60317869192373*^9, 
   3.603178701328137*^9}, {3.6031794189766817`*^9, 3.603179427033177*^9}, {
   3.60318093395551*^9, 3.60318093837959*^9}, {3.603181004387128*^9, 
   3.603181004706839*^9}, {3.6031818234194508`*^9, 3.603181871717923*^9}, {
   3.603182689824113*^9, 3.6031827475586243`*^9}, {3.6031827980232687`*^9, 
   3.603182838822213*^9}, 3.603182874210156*^9, {3.60318297482032*^9, 
   3.6031830368517942`*^9}, {3.6031831091232767`*^9, 3.603183111058762*^9}, {
   3.603183179458817*^9, 3.6031831998899*^9}, {3.6031838281695433`*^9, 
   3.603183852828175*^9}, {3.60318393782449*^9, 3.60318394848155*^9}, {
   3.603184158964561*^9, 3.603184159709022*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"system", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Ys", "[", "t", "]"}], ",", "t"}], "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"A", ".", 
      RowBox[{"Ys", "[", "t", "]"}]}], "+", "v"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y0", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Y0", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Y0", "[", 
    RowBox[{"[", "n", "]"}], "]"}], "=", "100"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"init", "=", 
   RowBox[{
    RowBox[{"Ys", "[", "0", "]"}], "\[Equal]", "Y0"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.603178705944067*^9, 3.603178726414339*^9}, {
   3.603179055146968*^9, 3.6031790933313007`*^9}, {3.603179124075365*^9, 
   3.603179125826285*^9}, {3.6031792303854733`*^9, 3.603179248651286*^9}, {
   3.60317937921773*^9, 3.603179406537402*^9}, {3.603179558704412*^9, 
   3.6031795601117764`*^9}, {3.6031798857813*^9, 3.60317991553237*^9}, 
   3.603180308057064*^9, {3.603180700924547*^9, 3.6031807351942177`*^9}, {
   3.603181073897717*^9, 3.6031810761313562`*^9}, {3.603181184634659*^9, 
   3.603181189495111*^9}, {3.603181672814231*^9, 3.603181720034504*^9}, {
   3.603181773422551*^9, 3.603181774877236*^9}, {3.6031818820133257`*^9, 
   3.603181883963344*^9}, {3.6031819848048162`*^9, 3.603181993987701*^9}, {
   3.603182454208631*^9, 3.603182459600268*^9}, {3.603182510528207*^9, 
   3.603182512016037*^9}, {3.6031826214910507`*^9, 3.6031826334195757`*^9}, {
   3.60318316038421*^9, 3.603183163041069*^9}, {3.603183977505393*^9, 
   3.603183989088977*^9}, {3.603184169830934*^9, 3.603184239396771*^9}, {
   3.6031842708046722`*^9, 3.603184277149115*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"NDSolveValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"system", ",", "init"}], "}"}], ",", 
     RowBox[{"Ys", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "500"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.603178729890547*^9, 3.6031787451259604`*^9}, {
   3.60317921896175*^9, 3.603179227529442*^9}, {3.603179467743309*^9, 
   3.603179479119628*^9}, {3.6031801219538183`*^9, 3.603180182720736*^9}, {
   3.603180278663333*^9, 3.603180281039019*^9}, {3.603180362096078*^9, 
   3.603180362335162*^9}, {3.6031804106562977`*^9, 3.60318041443987*^9}, {
   3.6031813223191566`*^9, 3.603181327419877*^9}, {3.603181666908183*^9, 
   3.60318166927565*^9}, {3.603181781939122*^9, 3.603181782082382*^9}, {
   3.603181935065516*^9, 3.6031819355776157`*^9}, {3.603182526437087*^9, 
   3.603182526628222*^9}, 3.6031840434557734`*^9, {3.603184078007805*^9, 
   3.6031840785105543`*^9}, 3.6031842910862637`*^9, 3.6031893767989273`*^9}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{"sol", ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "500"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.603180367562039*^9, 3.603180372036992*^9}, {
  3.6031804791646976`*^9, 3.603180484472439*^9}, {3.603184293052746*^9, 
  3.6031843274752483`*^9}}]
},
WindowSize->{1912, 1002},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowSelection->True,
CellContext->Notebook,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 927, 18, 121, "Input"],
Cell[1487, 40, 1954, 54, 209, "Input"],
Cell[3444, 96, 1391, 39, 143, "Input"],
Cell[4838, 137, 378, 6, 32, "Input"],
Cell[5219, 145, 1040, 19, 32, "Input"],
Cell[6262, 166, 1894, 43, 121, "Input"],
Cell[8159, 211, 1037, 19, 32, "Input"],
Cell[9199, 232, 311, 7, 32, "Input"]
}
]
*)

(* End of internal cache information *)
